<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Digital Logic Fundamentals Quiz - Digital Logic Gates</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="../../styles/theme.css">
    <script src="../../scripts/common.js"></script>
</head>
<body class="bg-gradient-to-br from-purple-50 to-indigo-100 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <header class="text-center mb-8">
            <h1 class="text-3xl font-bold text-purple-800 mb-2">Digital Logic Fundamentals Quiz</h1>
            <p class="text-purple-600">Topic: Digital Logic Gates</p>
            <div id="score-display" class="mt-4">
                <span class="bg-purple-100 text-purple-800 px-4 py-2 rounded-full font-semibold">
                    Score: <span id="current-score">0</span> / 10
                </span>
            </div>
        </header>

        <!-- Game Container -->
        <div id="game-container" class="max-w-2xl mx-auto">
            <div id="question-container" class="bg-white rounded-lg shadow-lg p-6 mb-6">
                <div id="progress-bar" class="w-full bg-gray-200 rounded-full h-2 mb-6">
                    <div id="progress" class="bg-purple-600 h-2 rounded-full" style="width: 0%"></div>
                </div>
                
                <div id="question-content">
                    <!-- Questions will be inserted here -->
                </div>
                <div class="flex justify-between mt-6">
                    <button id="prev-btn" class="btn-secondary" disabled>Previous</button>
                    <button id="next-btn" class="btn-primary">Next</button>
                    <button id="submit-btn" class="btn-primary hidden">Submit Quiz</button>
                </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Game Data
        const questions = [
        {
                "question": "What is a binary system?",
                "correct": 0,
                "options": [
                        "A system using two distinct states (e.g., 0 and 1)",
                        "A system that uses a continuous range of values",
                        "A system based on the decimal number system",
                        "A system that only uses analog signals"
                ]
        },
        {
                "question": "Which of the following best describes a digital signal?",
                "options": [
                        "A continuous electrical signal",
                        "A signal that can have any value within a range",
                        "A signal that has only two discrete levels, high or low",
                        "A signal used exclusively in analog clocks"
                ],
                "correct": 2
        },
        {
                "options": [
                        "To amplify analog signals",
                        "To perform a logical operation on one or more binary inputs to produce a single binary output",
                        "To store data in a non-volatile way",
                        "To convert digital signals to analog"
                ],
                "question": "What is the primary function of a logic gate?",
                "correct": 1
        },
        {
                "options": [
                        "To represent complex data structures",
                        "To measure the voltage of a circuit",
                        "To create alternating current",
                        "To represent the two states in a digital system, such as on/off or true/false"
                ],
                "correct": 3,
                "question": "In digital electronics, what are the binary digits 1 and 0 used for?"
        },
        {
                "options": [
                        "A visual representation of all possible inputs and the resulting outputs of a logic gate",
                        "A table showing the electrical resistance of a gate",
                        "A chart of the physical dimensions of a gate",
                        "A list of manufacturing dates for a component"
                ],
                "correct": 0,
                "question": "What is a truth table?"
        }
];
        
        // Game State
        let currentQuestion = 0;
        let score = 0;
        let answers = [];
        
        // Initialize game
        function initGame() {
            displayQuestion();
            updateProgress();
            window.__GAME_OK__ = true; // Validation flag
        }
        
        function displayQuestion() {
            const question = questions[currentQuestion];
            const container = document.getElementById('question-content');
            
            container.innerHTML = `
                <h3 class="text-xl font-semibold mb-4">${question.question}</h3>
                <div class="space-y-3">
                    ${question.options.map((option, index) => `
                        <label class="flex items-center p-3 border rounded-lg hover:bg-purple-50 cursor-pointer">
                            <input type="radio" name="answer" value="${index}" class="mr-3">
                            <span>${option}</span>
                        </label>
                    `).join('')}
                </div>
            `;
            
            // Update button states
            document.getElementById('prev-btn').disabled = currentQuestion === 0;
            document.getElementById('next-btn').style.display = currentQuestion === questions.length - 1 ? 'none' : 'block';
            document.getElementById('submit-btn').style.display = currentQuestion === questions.length - 1 ? 'block' : 'none';
        }
        
        function updateProgress() {
            const progress = ((currentQuestion + 1) / questions.length) * 100;
            document.getElementById('progress').style.width = progress + '%';
        }
        
        function nextQuestion() {
            saveAnswer();
            if (currentQuestion < questions.length - 1) {
                currentQuestion++;
                displayQuestion();
                updateProgress();
            }
        }
        
        function prevQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                displayQuestion();
                updateProgress();
            }
        }
        
        function saveAnswer() {
            const selected = document.querySelector('input[name="answer"]:checked');
            if (selected) {
                answers[currentQuestion] = parseInt(selected.value);
            }
        }
        
        function submitQuiz() {
            saveAnswer();
            calculateScore();
            showResults();
        }
        
        function calculateScore() {
            score = 0;
            questions.forEach((question, index) => {
                if (answers[index] === question.correct) {
                    score += 2; // 2 points per question = 10 total
                }
            });
            
            document.getElementById('current-score').textContent = score;
        }
        
        function showResults() {
            document.getElementById('question-container').classList.add('hidden');
            document.getElementById('results-screen').classList.remove('hidden');
            
            document.getElementById('final-score').textContent = score + ' / 10';
            
            let message = '';
            if (score >= 8) message = '🎉 Excellent work!';
            else if (score >= 6) message = '👍 Good job!';
            else if (score >= 4) message = '📚 Keep studying!';
            else message = '💪 Practice makes perfect!';
            
            document.getElementById('score-message').textContent = message;
            
            // Persist progress so topic page can read it later
            try {
                const key = 'digital-logic-gates';
                const existing = (window.CourseGenerator && window.CourseGenerator.loadProgress)
                    ? (window.CourseGenerator.loadProgress(key) || { "games": {} })
                    : { "games": {} };
                const prev = existing.games['intro-to-digital-logic-quiz'] || { "attempts": 0, "bestScore": 0 };
                existing.games['intro-to-digital-logic-quiz'] = {
                    "completed": true,
                    "score": score,
                    "attempts": (prev.attempts || 0) + 1,
                    "bestScore": Math.max(prev.bestScore || 0, score)
                };
                if (window.CourseGenerator && window.CourseGenerator.saveProgress) {
                    window.CourseGenerator.saveProgress(key, existing);
                }
            } catch (e) { /* ignore */ }
        }
        
        function retry() {
            currentQuestion = 0;
            score = 0;
            answers = [];
            document.getElementById('question-container').classList.remove('hidden');
            document.getElementById('results-screen').classList.add('hidden');
            initGame();
        }
        
        // Event Listeners
        document.getElementById('next-btn').addEventListener('click', nextQuestion);
        document.getElementById('prev-btn').addEventListener('click', prevQuestion);
        document.getElementById('submit-btn').addEventListener('click', submitQuiz);
        document.getElementById('retry-btn').addEventListener('click', retry);
        
        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', initGame);
    </script>
</body>
</html>